var isMobile=window.innerWidth<800;$(document).ready(function(){var a=function(){var a=window.innerHeight;isMobile||$(".ef-frame").css({height:a})};a(),window.addEventListener("resize",a)}),angular.module("eightfold",["ngSanitize","ngAnimate","duScroll"]).value("duScrollDuration",1e3).run(["$rootScope",function(a){window.history&&history.replaceState&&a.$on("duScrollspy:becameActive",function(a,b){var c=b.prop("hash").replace("#","#/");c&&history.replaceState(null,null,c)})}]).controller("efController",["$scope","$timeout","$rootScope","$http",function(a,b,c,d){a.isMobile=isMobile,a.showAboutMore=!1,a.hideAboutMore=function(){a.showAboutMore=!1},console.log("Loading...");var e=["img/lake.jpg","img/clouds.jpg","img/flowers.jpg"],f=0,g=function(){f++,f>=_.size(e)&&console.log("...Assets Loaded")};isMobile||_.forEach(e,function(a){var b=new Image;b.onLoad=g(),b.src=a});var h=function(c){b(function(){if(a.isMobile)var b=!0;else var b=4===$("video")[0].readyState;b?a.loaded=!0:h(1e3)},c)};h(1e3),a.showMenu=!1,a.toggleMenu=function(){a.showMenu=!a.showMenu},a.animateIn=!0,a.typography=["partials/attention-background.html","partials/emotion-background.html","partials/perception-background.html"],a.currentTypography=0,a.bannerTypography=a.typography[0];var i=null;a.getNextTypography=function(c){i&&b.cancel(i),void 0!==c&&(a.currentTypography=c),2==l?(a.bannerTypography=a.typography[a.currentTypography],i=b(function(){a.currentTypography++,a.currentTypography>=a.typography.length&&(a.currentTypography=0),a.getNextTypography()},5e3)):i=b(a.getNextTypography,2e3)},a.getNextTypography();var j=!1,k=1e3,l=0,m=_.map($(".ef-frame"),function(a){return"#"+a.id}),n=function(b){a.loaded&&!a.isMobile&&(b.preventDefault(),b.stopPropagation(),j===!1&&o(b.originalEvent.deltaY>0?1:-1))},o=function(a){j=!0;var b=window.innerHeight,c=l+a;c>=0&&c<m.length&&(l+=a),$("html, body").animate({scrollTop:b*l},k),i=setTimeout(function(){j=!1},k+250)};$(document).on("mousewheel, wheel",n),c.$on("duScrollspy:becameActive",function(a,b){l=m.indexOf(b.prop("hash"))}),a.formData={},a.contactStatus=null,b(function(){a.formData.hidden="human"},3e3),a.submitForm=function(c){return c!==!0||"human"!=a.formData.hidden?(a.errorMessage="Whoops! Looks like some fields aren't filled out properly.",void(a.contactStatus="error")):(a.contactStatus="loading",a.errorMessage="An error occurred while attempting to send your message.",void d({method:"POST",url:"_contact.php",data:$.param(a.formData),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(c,d,e,f){1==c?(console.log("success"),a.contactStatus="success",a.contactForm.$setPristine(),a.formData={},b(function(){a.contactStatus=null},2e3)):(console.log("error:",c,d),b(function(){a.contactStatus="error"},500))}).error(function(c,d,e,f){console.log("error:",c,d),b(function(){a.contactStatus="error"},500)}))}}]),angular.module("eightfold").directive("scrollReveal",["$timeout",function(a){return{scope:!0,template:'<div class="scroll-reveal" ng-class="{revealed:reveal}" ng-transclude></div>',replace:!0,transclude:!0,link:function(b,c,d,e){b.reveal=!1;var f=function(){console.log("revealed"),b.reveal!==!0&&c.offset().top-window.innerHeight<=$(window).scrollTop()&&a(function(){b.reveal=!0},100)};$(window).scroll(f),f()}}}]),angular.module("eightfold").directive("efPortfolio",["$http","$sce",function(a,b){return{name:"efPortfolio",scope:!1,controller:["$scope","$element","$attrs","$transclude",function(b,c,d,e){b.portfolio={},b.isMobile||(b.thumbHeight={height:window.innerHeight/2},window.addEventListener("resize",function(){b.thumbHeight={height:window.innerHeight/2},b.$apply()})),a.get("js/portfolio/portfolio.json").success(function(a,c,d,e){b.portfolio=a}).error(function(a,b,c,d){console.log(a)})}],templateUrl:"js/portfolio/ef-portfolio.html",replace:!0,link:function(a,c,d,e){a.playVideo=function(c){a.video=b.trustAsResourceUrl(c+"?autoplay=true&color=333"),a.videoVisible=!0},a.hideVideo=function(){a.videoVisible=!1}}}}]);